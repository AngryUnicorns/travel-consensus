!function(t){t.fn.tags=function(s){var e=this;s=s||{},s.separator=s.separator||",",s.add=s.add||function(){},s.remove=s.remove||function(){};var a={e:null,ed:null,tags:[],sep:s.separator,addCallBack:s.add,removeCallBack:s.remove,init:function(){this.e=e;var s=this,a=t(this.e).next();/jq_tags_editor/.test(a.attr("class"))?this.ed=a.get(0):(t(this.e).after('<div class="jq_tags_editor"><div class="jq_tags_tokens"></div><input type="text" class="jq_tags_editor_input" placeholder="'+t(this.e).attr("placeholder")+'"/></div>'),this.ed=t(this.e).next()),t(this.e).hide(),t(this.ed).unbind().click(function(){t(s.ed).find("input").focus()}).find("input").unbind().blur(function(){s.add_tag()}).keypress(function(t){switch(t.which){case 13:case s.sep.charCodeAt(0):t.preventDefault(),s.add_tag()}}),r=t(this.e).val().split(this.sep),this.tags=[];for(i in r)r[i]=r[i].replace(new RegExp('["'+this.sep+" ]","gi"),""),""!=r[i]&&this.tags.push(r[i]);this.refresh_list()},add_tag:function(){var i=t(this.ed).find("input").val().replace(new RegExp('["'+this.sep+" ]","gi"),"");""!=i&&jQuery.inArray(i,this.tags)<0&&(this.tags.push(i),this.refresh_list()),t(this.ed).find("input").val(""),this.addCallBack(i,this)},remove_tag:function(t){r=[];for(i in this.tags)this.tags[i]!=t&&r.push(this.tags[i]);this.tags=r,this.refresh_list(),this.removeCallBack(t,this)},refresh_list:function(){var s=this;t(this.ed).find("div.jq_tags_tokens").html(""),t(this.e).val(this.tags.join(this.sep+" ")),h="";for(i in s.tags)h+='<div class="jq_tags_token">'+s.tags[i]+'<a href="#">x</a></div>';t(s.ed).find("input").val(""),t(s.ed).find("div.jq_tags_tokens").html(h).find("div.jq_tags_token").find("a").click(function(){var i=t(this).parents(".jq_tags_token:first").html().replace(/<a(.*?)<\/a>/i,"").replace(/\&amp;/g,"&");return s.remove_tag(i),!1})}};return a.init(),this}}(jQuery);
